# Role
你是一位资深的 Python SEO 自动化工具开发专家，擅长处理静态站点生成器 (SSG) 的架构分析。

# Goal
请编写一个名为 `audit.py` 的全自动 SEO 审计脚本。该脚本需在当前目录下运行，针对 Cloudflare Pages/Vercel 等托管的静态 HTML 站点进行深度健康检查。

# Core Philosophy
1. **零配置 (Zero-Config)**: 自动从源码解析配置，无需用户输入。
2. **文件系统优先**: 内部链接检查必须基于本地文件存在性，严禁对内链发起 HTTP 请求（速度慢且易误报）。
3. **智能容错**: 能够识别 Clean URL 与本地 .html 文件的映射关系。

# Functional Requirements

## 1. 自动配置模块 (Auto-Configuration)
- **Base URL**: 读取根目录 `index.html` 的 `<link rel="canonical">`。若无，尝试读取 `og:url`，最后才提示警告。
- **Keywords**: 读取 `index.html` 的 `<meta name="keywords">`，用于后续内容相关性分析（预留）。
- **Ignore Lists (白名单)**:
  - **Path**: 忽略包含 `.git`, `node_modules`, `__pycache__` 的路径。
  - **URLs**: 忽略 `/go/` (短链跳转), `cdn-cgi`, `javascript:`, `mailto:`, `#` 开头的链接。
  - **Files**: 忽略文件名包含 `google` (验证文件) 或 `404.html` 的文件。

## 2. 核心审计逻辑 (Audit Logic)

### A. 智能路径与死链检测 (Smart Path Resolution) - *关键*
- **逻辑**: 遍历所有 `<a>` 标签的 `href`。
- **URL 规范性检查**:
  - ⚠️ 警告: 使用相对路径 (如 `href="blog/post"`) -> 提示应为 `/blog/post`。
  - ⚠️ 警告: 使用带域名的绝对路径 (如 `href="https://mydomain.com/blog"`) -> 提示应为 `/blog`。
  - ⚠️ 警告: 包含 `.html` 后缀 -> 提示应为 Clean URL。
- **死链判定 (本地映射)**:
  - 即使链接写得不规范（如相对路径），脚本也应尝试根据当前文件位置解析出目标文件的绝对路径。
  - **匹配规则**: 对于链接 `/blog/my-post`，依次检查本地是否存在：
    1. `root/blog/my-post.html`
    2. `root/blog/my-post/index.html`
  - 只有当上述文件都不存在时，才标记为 `[ERROR] Dead Link`。

### B. 权重传递与孤岛分析 (Link Equity)
- **Inbound Links**: 建立全站引用图 (Graph)，统计每个页面的入度。
- **Orphans**: 报告入度为 0 的页面（排除 index.html 和白名单文件）。
- **Top Pages**: 输出入度最高的前 10 个页面。

### C. 语义化与结构化 (Semantics)
- **H1 Check**: 每个页面必须有且仅有 1 个 `<h1>` 标签。
- **Schema Check**: 检查 `<head>` 或 `<body>` 中是否存在 `<script type="application/ld+json">`。
- **Breadcrumb**: 检查页面是否包含 `aria-label="breadcrumb"` 或 class 包含 `breadcrumb` 的导航元素。

### D. 外部链接健康度 (Async External Check)
- 提取所有指向外部域名的链接 (http/https)。
- 使用 `concurrent.futures.ThreadPoolExecutor` 并发发送 `HEAD` 请求。
- 仅当状态码 >= 400 时报错。
- 检查外链是否包含 `rel="nofollow"` (针对非权威站点) 或 `rel="noopener"`。

## 3. 报告输出 (Reporting)
- 使用 `colorama` 实现红/黄/绿/蓝彩色输出。
- 输出格式：
  - `[SUCCESS]`: 配置成功/关键指标达标
  - `[ERROR]`: 本地死链 (-10分), 外链死链 (-5分), 缺少 H1 (-5分)
  - `[WARN]`: URL 不规范 (-2分), 缺少 Schema (-2分), 孤岛页面 (-5分)
  - `[INFO]`: 统计数据
- **最终评分**: 满分 100，根据扣分项动态计算，最低 0 分。
- **Actionable Advice**: 如果分数低于 100，提示用户运行修复脚本（如 `fix_links.py` 或 `build.py`）。

# Tech Stack
- Python 3.x
- Libraries: `beautifulsoup4`, `requests`, `colorama`
- Error Handling: 文件读取需用 `utf-8` 并 `errors='ignore'`，防止特殊字符导致脚本崩溃。